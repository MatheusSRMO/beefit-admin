generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id        Int      @id @default(autoincrement())
    clerkId   String   @db.VarChar(100)
    email     String   @unique @db.VarChar(100)
    username  String   @unique @db.VarChar(100)
    photo     String   @db.VarChar(2000)
    firstName String?  @db.VarChar(100)
    lastName  String?  @db.VarChar(100)
    role      String   @default("USER") @db.VarChar(100) // USER | TRAINER | ADMIN
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    alunos    Aluno[]
}

model Aluno {
    id          Int      @id @default(autoincrement())
    clerkId     String   @db.VarChar(100)
    firstName   String   @db.VarChar(100)
    lastName    String   @db.VarChar(100)
    age         Int
    weight      Float
    height      Float
    goal        String?  @db.VarChar(100)
    observation String?  @db.VarChar(200)
    url         String?  @db.VarChar(2000)
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
    treinos     Treino[]
    user        User     @relation(fields: [userId], references: [id])
    userId      Int
}

model Treino {
    id         Int               @id @default(autoincrement())
    aluno      Aluno             @relation(fields: [alunoId], references: [id])
    alunoId    Int
    exercicios TreinoExercicio[]
    finalizado Boolean           @default(false)
    createdAt  DateTime          @default(now())
    updatedAt  DateTime          @updatedAt
}

model Exercicio {
    id         Int               @id @default(autoincrement())
    nome       String            @db.VarChar(100)
    gifLink    String            @db.VarChar(2000)
    repeticoes Int
    series     Int
    peso       Int
    treinos    TreinoExercicio[]
    createdAt  DateTime          @default(now())
    updatedAt  DateTime          @updatedAt
}

model TreinoExercicio {
    treino      Treino    @relation(fields: [treinoId], references: [id])
    treinoId    Int
    exercicio   Exercicio @relation(fields: [exercicioId], references: [id])
    exercicioId Int

    @@id([treinoId, exercicioId])
}
